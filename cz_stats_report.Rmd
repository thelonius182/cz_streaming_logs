---
title: "`r params$title`"
output: 
  pdf_document:
    latex_engine: xelatex
    number_sections: false
    toc: false
    keep_tex: false
fontsize: 10pt
geometry: top=0.5cm, bottom=2cm, left=2cm, right=1cm
params:
  title: "Default Title"
  data: NULL
---

```{r table, include=TRUE, echo=FALSE, results='asis'}
library(kableExtra)
library(dplyr)

# Sort data by weekday (optional: use custom weekday order)
cz_sorted <- params$data |>
  arrange(factor(weekday, levels = c(
    "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday", "TOTAL"
  )))

# Generate kable object
kbl_out <- kbl(
  cz_sorted,
  format = "latex",
  booktabs = TRUE,
  longtable = TRUE,
  caption = "Program Statistics",
  align = c("l", "c", "c", "c", "r", "r", "r")
) |>
  kable_styling(
    latex_options = "repeat_header",
    font_size = 10,
    position = "left"
  )

# Add group_rows for each weekday
unique_weekdays <- unique(cz_sorted$weekday)

row_index <- 1
for (wd in unique_weekdays) {
  num_rows <- sum(cz_sorted$weekday == wd)
  kbl_out <- group_rows(
    kbl_out,
    group_label = wd,
    start_row = row_index,
    end_row = row_index + num_rows - 1
  )
  row_index <- row_index + num_rows
}

# Render final table
kbl_out
```

\begin{samepage}

\textbf{Toelichting}

\begin{itemize}
  \item \textbf{bc\_hours} -- Broadcast hours: aantal uitgezonden uren  
  \item \textbf{unique\_ips} -- Aantal IP-adressen: unieke luisteraars  
  \item \textbf{tot\_hours} -- Aantal luisteruren  
\end{itemize}

\end{samepage}
