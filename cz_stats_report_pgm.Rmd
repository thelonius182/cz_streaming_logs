---
title: "`r params$title`"
output: 
  pdf_document:
    latex_engine: xelatex
    number_sections: false
    toc: false
    keep_tex: false
fontsize: 10pt
geometry: top=0.5cm, bottom=2cm, left=2cm, right=1cm
params:
  title: "Default Title"
  data: NULL
---

```{r table, include=TRUE, echo=FALSE, results='asis'}
library(kableExtra)
library(dplyr)

# Sort data by weekday (optional: use custom weekday order)
cz_sorted <- params$data |>
  arrange(factor(dag, levels = c(
    "maandag", "dinsdag", "woensdag", "donderdag", "vrijdag", "zaterdag", "zondag", "TOTAAL"
  )))

# Generate kable object
kbl_out <- kbl(
  cz_sorted,
  format = "latex",
  booktabs = TRUE,
  longtable = TRUE,
  caption = "Overzicht per uitzending",
  align = c("l", "c", "c", "c", "r", "r")
) |>
  kable_styling(
    latex_options = "repeat_header",
    font_size = 10,
    position = "left"
  )

# Add group_rows for each weekday
unique_weekdays <- unique(cz_sorted$dag)

row_index <- 1
for (wd in unique_weekdays) {
  num_rows <- sum(cz_sorted$dag == wd)
  kbl_out <- group_rows(
    kbl_out,
    group_label = wd,
    start_row = row_index,
    end_row = row_index + num_rows - 1
  )
  row_index <- row_index + num_rows
}

# Render final table
kbl_out
```

\begin{samepage}

\textbf{Toelichting:}
\begin{itemize}
  \item Deze cijfers slaan alleen op uitzendingen via de \textbf{Luister Live}-kanalen.
  \item De cijfers voor \textbf{Radio onDemand} en \textbf{Themakanalen} zijn niet per programmatitel beschikbaar, alleen op dag- en maandniveau over alle programmatitels samen. Zie daarvoor \textbf{Themakanalen \& OnDemand.pdf}.
\end{itemize}

\end{samepage}
